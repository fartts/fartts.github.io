{"version":3,"sources":["13-game-of-life/pkg/game_of_life.js","13-game-of-life/src/lib.rs","../lib/core/dom.ts","../lib/core/math.ts","../lib/game/loop.ts","13-game-of-life/src/entry.ts"],"names":["init","__exports","wasm","cachedTextDecoder","TextDecoder","cachegetUint8Memory","getUint8Memory","buffer","memory","Uint8Array","getStringFromWasm","ptr","len","decode","subarray","__wbg_error_4bb6c2a97407129a","arg0","arg1","varg0","slice","__wbindgen_free","console","error","heap","Array","fill","undefined","push","heap_next","length","addHeapObject","obj","idx","__wbg_new_59cb74e423758ede","Error","getObject","passStringToWasm","WASM_VECTOR_LEN","cachedTextEncoder","TextEncoder","encodeInto","arg","size","__wbindgen_malloc","offset","mem","code","charCodeAt","__wbindgen_realloc","view","written","buf","encode","set","cachegetUint32Memory","getUint32Memory","Uint32Array","__wbg_stack_558ba5917b466edd","ret","retptr","stack","retlen","handleError","exnptr","e","__widl_f_set_property_CSSStyleDeclaration","arg2","arg3","arg4","varg1","varg3","setProperty","__widl_instanceof_CanvasRenderingContext2D","CanvasRenderingContext2D","__widl_f_set_fill_style_CanvasRenderingContext2D","fillStyle","__widl_f_fill_rect_CanvasRenderingContext2D","fillRect","__widl_f_x_DOMRect","x","__widl_f_y_DOMRect","y","isLikeNone","__widl_f_query_selector_Document","val","querySelector","__widl_f_get_bounding_client_rect_Element","getBoundingClientRect","__widl_f_client_width_Element","clientWidth","__widl_f_client_height_Element","clientHeight","__widl_instanceof_HTMLCanvasElement","HTMLCanvasElement","__widl_f_get_context_HTMLCanvasElement","getContext","__widl_f_width_HTMLCanvasElement","width","__widl_f_set_width_HTMLCanvasElement","__widl_f_height_HTMLCanvasElement","height","__widl_f_set_height_HTMLCanvasElement","__widl_instanceof_HTMLElement","HTMLElement","__widl_f_style_HTMLElement","style","__widl_instanceof_Window","Window","__widl_f_document_Window","document","__widl_f_device_pixel_ratio_Window","devicePixelRatio","__wbg_newnoargs_a172f39151049128","Function","__wbg_call_8a9c8b0a32a202ff","call","__wbindgen_string_new","p","l","__wbindgen_debug_string","i","len_ptr","debug_str","type","description","name","isArray","debug","builtInMatches","exec","toString","className","JSON","stringify","_","message","Object","prototype","dropObject","takeObject","__wbindgen_rethrow","__wbindgen_throw","freeSim","__wbg_sim_free","Sim","__wrap","create","free","new","sim_new","resize","sim_resize","update","_current_time","_delta_time","sim_update","render","_frame_ratio","sim_render","draw","client_x","client_y","sim_draw","__wbindgen_object_clone_ref","__wbindgen_object_drop_ref","module","result","imports","URL","Request","response","fetch","WebAssembly","instantiateStreaming","catch","warn","then","r","arrayBuffer","bytes","instantiate","Instance","instance","exports","__wbindgen_wasm_module","require"],"mappings":"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","file":"entry.bcd9af1f.js","sourceRoot":"../src/lab","sourcesContent":["\nconst __exports = {};\nlet wasm;\n\nlet cachedTextDecoder = new TextDecoder('utf-8');\n\nlet cachegetUint8Memory = null;\nfunction getUint8Memory() {\n    if (cachegetUint8Memory === null || cachegetUint8Memory.buffer !== wasm.memory.buffer) {\n        cachegetUint8Memory = new Uint8Array(wasm.memory.buffer);\n    }\n    return cachegetUint8Memory;\n}\n\nfunction getStringFromWasm(ptr, len) {\n    return cachedTextDecoder.decode(getUint8Memory().subarray(ptr, ptr + len));\n}\n\nfunction __wbg_error_4bb6c2a97407129a(arg0, arg1) {\n    let varg0 = getStringFromWasm(arg0, arg1);\n\n    varg0 = varg0.slice();\n    wasm.__wbindgen_free(arg0, arg1 * 1);\n\n    console.error(varg0);\n}\n__exports.__wbg_error_4bb6c2a97407129a = __wbg_error_4bb6c2a97407129a\n\nconst heap = new Array(32);\n\nheap.fill(undefined);\n\nheap.push(undefined, null, true, false);\n\nlet heap_next = heap.length;\n\nfunction addHeapObject(obj) {\n    if (heap_next === heap.length) heap.push(heap.length + 1);\n    const idx = heap_next;\n    heap_next = heap[idx];\n\n    heap[idx] = obj;\n    return idx;\n}\n\nfunction __wbg_new_59cb74e423758ede() {\n    return addHeapObject(new Error());\n}\n__exports.__wbg_new_59cb74e423758ede = __wbg_new_59cb74e423758ede\n\nfunction getObject(idx) { return heap[idx]; }\n\nlet WASM_VECTOR_LEN = 0;\n\nlet cachedTextEncoder = new TextEncoder('utf-8');\n\nlet passStringToWasm;\nif (typeof cachedTextEncoder.encodeInto === 'function') {\n    passStringToWasm = function(arg) {\n\n\n        let size = arg.length;\n        let ptr = wasm.__wbindgen_malloc(size);\n        let offset = 0;\n        {\n            const mem = getUint8Memory();\n            for (; offset < arg.length; offset++) {\n                const code = arg.charCodeAt(offset);\n                if (code > 0x7F) break;\n                mem[ptr + offset] = code;\n            }\n        }\n\n        if (offset !== arg.length) {\n            arg = arg.slice(offset);\n            ptr = wasm.__wbindgen_realloc(ptr, size, size = offset + arg.length * 3);\n            const view = getUint8Memory().subarray(ptr + offset, ptr + size);\n            const ret = cachedTextEncoder.encodeInto(arg, view);\n\n            offset += ret.written;\n        }\n        WASM_VECTOR_LEN = offset;\n        return ptr;\n    };\n} else {\n    passStringToWasm = function(arg) {\n\n\n        let size = arg.length;\n        let ptr = wasm.__wbindgen_malloc(size);\n        let offset = 0;\n        {\n            const mem = getUint8Memory();\n            for (; offset < arg.length; offset++) {\n                const code = arg.charCodeAt(offset);\n                if (code > 0x7F) break;\n                mem[ptr + offset] = code;\n            }\n        }\n\n        if (offset !== arg.length) {\n            const buf = cachedTextEncoder.encode(arg.slice(offset));\n            ptr = wasm.__wbindgen_realloc(ptr, size, size = offset + buf.length);\n            getUint8Memory().set(buf, ptr + offset);\n            offset += buf.length;\n        }\n        WASM_VECTOR_LEN = offset;\n        return ptr;\n    };\n}\n\nlet cachegetUint32Memory = null;\nfunction getUint32Memory() {\n    if (cachegetUint32Memory === null || cachegetUint32Memory.buffer !== wasm.memory.buffer) {\n        cachegetUint32Memory = new Uint32Array(wasm.memory.buffer);\n    }\n    return cachegetUint32Memory;\n}\n\nfunction __wbg_stack_558ba5917b466edd(ret, arg0) {\n\n    const retptr = passStringToWasm(getObject(arg0).stack);\n    const retlen = WASM_VECTOR_LEN;\n    const mem = getUint32Memory();\n    mem[ret / 4] = retptr;\n    mem[ret / 4 + 1] = retlen;\n\n}\n__exports.__wbg_stack_558ba5917b466edd = __wbg_stack_558ba5917b466edd\n\nfunction handleError(exnptr, e) {\n    const view = getUint32Memory();\n    view[exnptr / 4] = 1;\n    view[exnptr / 4 + 1] = addHeapObject(e);\n}\n\nfunction __widl_f_set_property_CSSStyleDeclaration(arg0, arg1, arg2, arg3, arg4, exnptr) {\n    let varg1 = getStringFromWasm(arg1, arg2);\n    let varg3 = getStringFromWasm(arg3, arg4);\n    try {\n        getObject(arg0).setProperty(varg1, varg3);\n    } catch (e) {\n        handleError(exnptr, e);\n    }\n}\n__exports.__widl_f_set_property_CSSStyleDeclaration = __widl_f_set_property_CSSStyleDeclaration\n\nfunction __widl_instanceof_CanvasRenderingContext2D(idx) { return getObject(idx) instanceof CanvasRenderingContext2D ? 1 : 0; }\n__exports.__widl_instanceof_CanvasRenderingContext2D = __widl_instanceof_CanvasRenderingContext2D\n\nfunction __widl_f_set_fill_style_CanvasRenderingContext2D(arg0, arg1) {\n    getObject(arg0).fillStyle = getObject(arg1);\n}\n__exports.__widl_f_set_fill_style_CanvasRenderingContext2D = __widl_f_set_fill_style_CanvasRenderingContext2D\n\nfunction __widl_f_fill_rect_CanvasRenderingContext2D(arg0, arg1, arg2, arg3, arg4) {\n    getObject(arg0).fillRect(arg1, arg2, arg3, arg4);\n}\n__exports.__widl_f_fill_rect_CanvasRenderingContext2D = __widl_f_fill_rect_CanvasRenderingContext2D\n\nfunction __widl_f_x_DOMRect(arg0) {\n    return getObject(arg0).x;\n}\n__exports.__widl_f_x_DOMRect = __widl_f_x_DOMRect\n\nfunction __widl_f_y_DOMRect(arg0) {\n    return getObject(arg0).y;\n}\n__exports.__widl_f_y_DOMRect = __widl_f_y_DOMRect\n\nfunction isLikeNone(x) {\n    return x === undefined || x === null;\n}\n\nfunction __widl_f_query_selector_Document(arg0, arg1, arg2, exnptr) {\n    let varg1 = getStringFromWasm(arg1, arg2);\n    try {\n\n        const val = getObject(arg0).querySelector(varg1);\n        return isLikeNone(val) ? 0 : addHeapObject(val);\n\n    } catch (e) {\n        handleError(exnptr, e);\n    }\n}\n__exports.__widl_f_query_selector_Document = __widl_f_query_selector_Document\n\nfunction __widl_f_get_bounding_client_rect_Element(arg0) {\n    return addHeapObject(getObject(arg0).getBoundingClientRect());\n}\n__exports.__widl_f_get_bounding_client_rect_Element = __widl_f_get_bounding_client_rect_Element\n\nfunction __widl_f_client_width_Element(arg0) {\n    return getObject(arg0).clientWidth;\n}\n__exports.__widl_f_client_width_Element = __widl_f_client_width_Element\n\nfunction __widl_f_client_height_Element(arg0) {\n    return getObject(arg0).clientHeight;\n}\n__exports.__widl_f_client_height_Element = __widl_f_client_height_Element\n\nfunction __widl_instanceof_HTMLCanvasElement(idx) { return getObject(idx) instanceof HTMLCanvasElement ? 1 : 0; }\n__exports.__widl_instanceof_HTMLCanvasElement = __widl_instanceof_HTMLCanvasElement\n\nfunction __widl_f_get_context_HTMLCanvasElement(arg0, arg1, arg2, exnptr) {\n    let varg1 = getStringFromWasm(arg1, arg2);\n    try {\n\n        const val = getObject(arg0).getContext(varg1);\n        return isLikeNone(val) ? 0 : addHeapObject(val);\n\n    } catch (e) {\n        handleError(exnptr, e);\n    }\n}\n__exports.__widl_f_get_context_HTMLCanvasElement = __widl_f_get_context_HTMLCanvasElement\n\nfunction __widl_f_width_HTMLCanvasElement(arg0) {\n    return getObject(arg0).width;\n}\n__exports.__widl_f_width_HTMLCanvasElement = __widl_f_width_HTMLCanvasElement\n\nfunction __widl_f_set_width_HTMLCanvasElement(arg0, arg1) {\n    getObject(arg0).width = arg1 >>> 0;\n}\n__exports.__widl_f_set_width_HTMLCanvasElement = __widl_f_set_width_HTMLCanvasElement\n\nfunction __widl_f_height_HTMLCanvasElement(arg0) {\n    return getObject(arg0).height;\n}\n__exports.__widl_f_height_HTMLCanvasElement = __widl_f_height_HTMLCanvasElement\n\nfunction __widl_f_set_height_HTMLCanvasElement(arg0, arg1) {\n    getObject(arg0).height = arg1 >>> 0;\n}\n__exports.__widl_f_set_height_HTMLCanvasElement = __widl_f_set_height_HTMLCanvasElement\n\nfunction __widl_instanceof_HTMLElement(idx) { return getObject(idx) instanceof HTMLElement ? 1 : 0; }\n__exports.__widl_instanceof_HTMLElement = __widl_instanceof_HTMLElement\n\nfunction __widl_f_style_HTMLElement(arg0) {\n    return addHeapObject(getObject(arg0).style);\n}\n__exports.__widl_f_style_HTMLElement = __widl_f_style_HTMLElement\n\nfunction __widl_instanceof_Window(idx) { return getObject(idx) instanceof Window ? 1 : 0; }\n__exports.__widl_instanceof_Window = __widl_instanceof_Window\n\nfunction __widl_f_document_Window(arg0) {\n\n    const val = getObject(arg0).document;\n    return isLikeNone(val) ? 0 : addHeapObject(val);\n\n}\n__exports.__widl_f_document_Window = __widl_f_document_Window\n\nfunction __widl_f_device_pixel_ratio_Window(arg0) {\n    return getObject(arg0).devicePixelRatio;\n}\n__exports.__widl_f_device_pixel_ratio_Window = __widl_f_device_pixel_ratio_Window\n\nfunction __wbg_newnoargs_a172f39151049128(arg0, arg1) {\n    let varg0 = getStringFromWasm(arg0, arg1);\n    return addHeapObject(new Function(varg0));\n}\n__exports.__wbg_newnoargs_a172f39151049128 = __wbg_newnoargs_a172f39151049128\n\nfunction __wbg_call_8a9c8b0a32a202ff(arg0, arg1, exnptr) {\n    try {\n        return addHeapObject(getObject(arg0).call(getObject(arg1)));\n    } catch (e) {\n        handleError(exnptr, e);\n    }\n}\n__exports.__wbg_call_8a9c8b0a32a202ff = __wbg_call_8a9c8b0a32a202ff\n\nfunction __wbindgen_string_new(p, l) { return addHeapObject(getStringFromWasm(p, l)); }\n__exports.__wbindgen_string_new = __wbindgen_string_new\n\nfunction __wbindgen_debug_string(i, len_ptr) {\n    const debug_str =\n    val => {\n        // primitive types\n        const type = typeof val;\n        if (type == 'number' || type == 'boolean' || val == null) {\n            return  `${val}`;\n        }\n        if (type == 'string') {\n            return `\"${val}\"`;\n        }\n        if (type == 'symbol') {\n            const description = val.description;\n            if (description == null) {\n                return 'Symbol';\n            } else {\n                return `Symbol(${description})`;\n            }\n        }\n        if (type == 'function') {\n            const name = val.name;\n            if (typeof name == 'string' && name.length > 0) {\n                return `Function(${name})`;\n            } else {\n                return 'Function';\n            }\n        }\n        // objects\n        if (Array.isArray(val)) {\n            const length = val.length;\n            let debug = '[';\n            if (length > 0) {\n                debug += debug_str(val[0]);\n            }\n            for(let i = 1; i < length; i++) {\n                debug += ', ' + debug_str(val[i]);\n            }\n            debug += ']';\n            return debug;\n        }\n        // Test for built-in\n        const builtInMatches = /\\[object ([^\\]]+)\\]/.exec(toString.call(val));\n        let className;\n        if (builtInMatches.length > 1) {\n            className = builtInMatches[1];\n        } else {\n            // Failed to match the standard '[object ClassName]'\n            return toString.call(val);\n        }\n        if (className == 'Object') {\n            // we're a user defined class or Object\n            // JSON.stringify avoids problems with cycles, and is generally much\n            // easier than looping through ownProperties of `val`.\n            try {\n                return 'Object(' + JSON.stringify(val) + ')';\n            } catch (_) {\n                return 'Object';\n            }\n        }\n        // errors\n        if (val instanceof Error) {\n        return `${val.name}: ${val.message}\n        ${val.stack}`;\n    }\n    // TODO we could test for more things here, like `Set`s and `Map`s.\n    return className;\n}\n;\nconst toString = Object.prototype.toString;\nconst val = getObject(i);\nconst debug = debug_str(val);\nconst ptr = passStringToWasm(debug);\ngetUint32Memory()[len_ptr / 4] = WASM_VECTOR_LEN;\nreturn ptr;\n}\n__exports.__wbindgen_debug_string = __wbindgen_debug_string\n\nfunction dropObject(idx) {\n    if (idx < 36) return;\n    heap[idx] = heap_next;\n    heap_next = idx;\n}\n\nfunction takeObject(idx) {\n    const ret = getObject(idx);\n    dropObject(idx);\n    return ret;\n}\n\nfunction __wbindgen_rethrow(idx) { throw takeObject(idx); }\n__exports.__wbindgen_rethrow = __wbindgen_rethrow\n\nfunction __wbindgen_throw(ptr, len) {\n    throw new Error(getStringFromWasm(ptr, len));\n}\n__exports.__wbindgen_throw = __wbindgen_throw\n\nfunction freeSim(ptr) {\n\n    wasm.__wbg_sim_free(ptr);\n}\n/**\n*/\nexport class Sim {\n\n    static __wrap(ptr) {\n        const obj = Object.create(Sim.prototype);\n        obj.ptr = ptr;\n\n        return obj;\n    }\n\n    free() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n        freeSim(ptr);\n    }\n\n    /**\n    * @returns {Sim}\n    */\n    static new() {\n        return Sim.__wrap(wasm.sim_new());\n    }\n    /**\n    * @returns {void}\n    */\n    resize() {\n        return wasm.sim_resize(this.ptr);\n    }\n    /**\n    * @param {number} _current_time\n    * @param {number} _delta_time\n    * @returns {void}\n    */\n    update(_current_time, _delta_time) {\n        return wasm.sim_update(this.ptr, _current_time, _delta_time);\n    }\n    /**\n    * @param {number} _frame_ratio\n    * @returns {void}\n    */\n    render(_frame_ratio) {\n        return wasm.sim_render(this.ptr, _frame_ratio);\n    }\n    /**\n    * @param {number} client_x\n    * @param {number} client_y\n    * @returns {void}\n    */\n    draw(client_x, client_y) {\n        return wasm.sim_draw(this.ptr, client_x, client_y);\n    }\n}\n\nfunction __wbindgen_object_clone_ref(idx) {\n    return addHeapObject(getObject(idx));\n}\n__exports.__wbindgen_object_clone_ref = __wbindgen_object_clone_ref\n\nfunction __wbindgen_object_drop_ref(i) { dropObject(i); }\n__exports.__wbindgen_object_drop_ref = __wbindgen_object_drop_ref\n\nfunction init(module) {\n    let result;\n    const imports = { './game_of_life': __exports };\n\n    if (module instanceof URL || typeof module === 'string' || module instanceof Request) {\n\n        const response = fetch(module);\n        if (typeof WebAssembly.instantiateStreaming === 'function') {\n            result = WebAssembly.instantiateStreaming(response, imports)\n            .catch(e => {\n                console.warn(\"`WebAssembly.instantiateStreaming` failed. Assuming this is because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n\", e);\n                return response\n                .then(r => r.arrayBuffer())\n                .then(bytes => WebAssembly.instantiate(bytes, imports));\n            });\n        } else {\n            result = response\n            .then(r => r.arrayBuffer())\n            .then(bytes => WebAssembly.instantiate(bytes, imports));\n        }\n    } else {\n\n        result = WebAssembly.instantiate(module, imports)\n        .then(result => {\n            if (result instanceof WebAssembly.Instance) {\n                return { instance: result, module };\n            } else {\n                return result;\n            }\n        });\n    }\n    return result.then(({instance, module}) => {\n        wasm = instance.exports;\n        init.__wbindgen_wasm_module = module;\n\n        return { Sim };\n    });\n}\n\nexport default init;\n\n","import init from '../pkg/game_of_life.js';\nmodule.exports = init(require('../pkg/game_of_life_bg.wasm'));\n","export const {\n  requestAnimationFrame: rAF,\n  cancelAnimationFrame: cAF,\n  devicePixelRatio: dpr,\n} = window;\n\nexport function el(selectors: string): Element | null {\n  return document.querySelector(selectors);\n}\n\ntype Listener<T extends Event> = (event: T) => void;\n\nexport function on<T extends Event>(type: string, listener: Listener<T>): void {\n  return window.addEventListener(type, listener as EventListener);\n}\n\nexport function off<T extends Event>(\n  type: string,\n  listener: Listener<T>,\n): void {\n  return window.removeEventListener(type, listener as EventListener);\n}\n","export const {\n  abs,\n  acos,\n  atan2,\n  ceil,\n  cos,\n  floor,\n  hypot,\n  max,\n  min,\n  PI: π,\n  pow,\n  round,\n  sin,\n  sqrt,\n} = Math;\nexport const ππ = π * 2;\nexport const { isFinite } = Number;\n\n/**\n * ## lerp\n * short for \"linear interpolate\" this function returns a number that is\n * interpolated between `a` and `b` by the ratio provided in `i` (e.g. if `i` is\n * 0 `a` is returned, if `i` is 1 `b` is returned)\n *\n * @export\n * @param {number} v0 the lower bound of the interpolation\n * @param {number} v1 the upper bound of the interpolation\n * @param {number} t the ratio by which to interpolate between `a` and `b`\n * @returns {number} a number that is interpolated between `a` and `b` by the\n * ratio provided in `i`\n */\nexport function lerp(v0: number, v1: number, t: number): number {\n  /**\n   * prefer precise method\n   * @see: https://github.com/mattdesl/lerp/blob/master/index.js\n   * @see: https://en.wikipedia.org/wiki/Linear_interpolation#Programming_language_support\n   */\n  return (1 - t) * v0 + t * v1;\n}\n\n/**\n * ## saw\n * this is a trigonometric function (like Math.sin, or Math.cos), it takes an\n * angle in radians and returns a value between -1 and 1, the \"shape\" of the\n * returned values follows a linear \"sawtooth\" pattern\n *\n * @export\n * @param {number} radians a value in radians (clamped between 0 and ππ)\n * @returns {number} a value between -1 and 1 for entry values between 0 and ππ\n */\nexport function saw(radians: number): number {\n  return (radians % ππ) / π - 1;\n}\n\n/**\n * ## tri\n * this is a trigonometric function (like Math.sin, or Math.cos), it takes an\n * angle in radians and returns a value between -1 and 1, the \"shape\" of the\n * returned values follows a linear \"triangle wave\" pattern\n *\n * @export\n * @param {number} radians a value in radians (clamped between 0 and ππ)\n * @returns {number} a value between -1 and 1 for entry values between 0 and ππ\n */\nexport function tri(radians: number): number {\n  return 1 - 2 * abs(saw(radians));\n}\n\n/**\n * ## toDegrees\n * takes an angle in radians and returns that angle in degrees\n *\n * @param {number} radians an angle, in radians\n * @return {number} that same angle, in degrees\n */\nexport function toDegrees(radians: number): number {\n  return (radians * 180) / π;\n}\n\n/**\n * ## toRadians\n * takes an angle in degrees and returns that angle in radians\n *\n * @param {number} degrees an angle, in degrees\n * @return {number} that same angle, in radians\n */\nexport function toRadians(degrees: number): number {\n  return (degrees * π) / 180;\n}\n","import { rAF, cAF } from '../core/dom';\nimport { min } from '../core/math';\n\ntype UpdateFunction = (t: number, dt: number) => void;\ntype RenderFunction = (lag: number) => void;\n\nexport const stepTime = 1000 / 60;\n\nlet frameId = -1;\n\nlet firstTime = 0;\nlet previousTime = 0;\n\nlet overTime = 0;\n\nlet currentTime = 0;\nlet deltaTime = 0;\n\nexport default function loop(\n  update: UpdateFunction,\n  render: RenderFunction,\n): { isRunning: boolean; start: () => void; stop: () => void } {\n  function tick(time: DOMHighResTimeStamp) {\n    frameId = rAF(tick);\n\n    currentTime = time - firstTime;\n    deltaTime = currentTime - previousTime;\n\n    previousTime = currentTime;\n    overTime += deltaTime;\n\n    overTime = min(overTime, 1000);\n\n    while (overTime >= stepTime) {\n      update(currentTime, stepTime);\n      overTime -= stepTime;\n    }\n\n    render(overTime / stepTime);\n  }\n\n  return {\n    get isRunning() {\n      return frameId !== -1;\n    },\n\n    start() {\n      if (frameId !== -1) {\n        return;\n      }\n\n      frameId = rAF((time: DOMHighResTimeStamp) => {\n        frameId = rAF(tick);\n\n        render(1);\n\n        firstTime = time;\n        previousTime = 0;\n        overTime = 0;\n      });\n    },\n\n    stop() {\n      if (frameId === -1) {\n        return;\n      }\n\n      cAF(frameId);\n      frameId = -1;\n    },\n  };\n}\n","import { Sim } from './lib.rs';\nimport { el } from '../../../lib/core/dom';\nimport loop from '../../../lib/game/loop';\nimport './style.css';\n\nconst sim = Sim.new();\nconst main = loop(\n  (t, dt) => {\n    sim.update(t, dt);\n  },\n  lag => {\n    sim.render(lag);\n  },\n);\n\nlet pointerDown = false;\n\nfunction mousePointer(event: MouseEvent) {\n  event.preventDefault();\n  pointerDown = event.buttons !== 0;\n  pointerDown ? main.stop() : main.start();\n  mousePointerMove(event);\n}\n\nfunction touchPointer(event: TouchEvent) {\n  event.preventDefault();\n  pointerDown = event.touches.length !== 0;\n  pointerDown ? main.stop() : main.start();\n  touchPointerMove(event);\n}\n\nfunction mousePointerMove(event: MouseEvent) {\n  event.preventDefault();\n  if (!pointerDown) {\n    return;\n  }\n\n  const { clientX, clientY } = event;\n  sim.draw(clientX, clientY);\n}\n\nfunction touchPointerMove(event: TouchEvent) {\n  event.preventDefault();\n  if (!pointerDown) {\n    return;\n  }\n\n  const touches = Array.from(event.touches);\n\n  // handle multiple touches by averaging them, will sort of draw \"in the\n  // middle\" of all the touches\n  const { clientX, clientY } = touches.reduce(\n    (acc, touch) => ({\n      clientX: acc.clientX + touch.clientX,\n      clientY: acc.clientY + touch.clientY,\n    }),\n    {\n      clientX: 0,\n      clientY: 0,\n    },\n  );\n\n  sim.draw(clientX / touches.length, clientY / touches.length);\n}\n\nfunction on<\n  T extends EventTarget,\n  U extends keyof DocumentEventMap,\n  V = (this: T, event: DocumentEventMap[U]) => any\n>(target: T, forEvent: U, listener: V) {\n  target.addEventListener(forEvent, (listener as unknown) as EventListener);\n}\n\nconst canvas = el('canvas') as HTMLCanvasElement;\n\non(canvas, 'mousedown', mousePointer);\non(canvas, 'mouseup', mousePointer);\non(canvas, 'mouseenter', mousePointer);\non(canvas, 'mouseleave', mousePointer);\non(canvas, 'mousemove', mousePointerMove);\non(canvas, 'touchstart', touchPointer);\non(canvas, 'touchend', touchPointer);\non(canvas, 'touchmove', touchPointerMove);\n\non(window, 'resize', () => {\n  main.stop();\n  sim.resize();\n});\n\nmain.start();\n"]}